{% extends 'base.html' %}
{% load static %}

{% block title %}Superintendent Portal{% endblock %}

{% block link %}
<link rel="stylesheet" type="text/css" href="{% static 'superintendent_css.css' %}">
<script>
$(document).ready(function(){
  $(".flip").click(function(){
    $(this).find(".details").slideToggle("fast");
  });
});
</script>
{% endblock %}

{% block logo %}<a class="navbar-brand" style="color: #343a40;">{{request.user.first_name}} {{request.user.last_name}}</a>{% endblock %}

{% block logout_btn %}<a class="nav-link" href="{% url 'user_logout' %}" style="color: #6c757d; text-decoration: none;">Logout</a>{% endblock %}

{# ... st_dashboard.html ... #}
{% block content %}

<h4 class="superintendent-title">Received Question Papers</h4>
<hr class="superintendent-hr">

<div class="papers-container">
{% for item in final_papers_data %}
    {% with teacher=item.paper %}
        <div class="card bg-light text-dark flip superintendent-paper-card" id="{{teacher.id}}">
            <div class="card-body">
                <h5 class="card-title">Subject: {{teacher.subject}} ({{teacher.s_code}})</h5>
                <p class="card-text">Click to view paper details and download options.</p>
                <div class="details" id="details"><br>
                    Subject Code: <span class="detail-value">{{teacher.s_code}}</span><br>
                    Course: <span class="detail-value">{{teacher.course}}</span><br>
                    Semester: <span class="detail-value">{{teacher.semester}}</span><br>
                    Branch: <span class="detail-value">{{teacher.branch}}</span><br>
                    Subject: <span class="detail-value">{{teacher.subject}}</span><br>
                    Question Paper:
                    {% if item.downloadable and not item.already_downloaded %}
                      <form method="POST" class="download-form">
                         {% csrf_token %}
                         <input type="hidden" name="paper_id" value="{{ teacher.contract_paper_id }}">
                         <button type="submit" class="btn btn-primary superintendent-download-btn">Download Paper</button>
                      </form>
                    {% elif item.already_downloaded %}
                        <span class="download-status downloaded">Downloaded</span>
                    {% else %}
                        <span class="download-status pending">Download available 20 minutes before exam.</span><br>
                        <span class="exam-time">Exam Time: {{ item.exam_time }}</span><br>
                        <span class="time-diff">Time Difference: {{ item.timediff }}</span><br>
                    {% endif %}
                </div>
            </div>
        </div><br>
    {% endwith %}
{% endfor %}
</div>

{% endblock %}